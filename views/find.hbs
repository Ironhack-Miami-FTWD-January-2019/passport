<h1>{{user.username}}'s HotSpots</h1>

{{#each hotspots}}
  {{this.name}}<br>
  {{this.location}}<br>
  {{this.kind}}<br>
  {{this.genre}}<br>
{{/each}}

<div id="map"></div>
{{data}}
<script>
  function initMap(){
    // Map Options
    var options = {
      zoom:16,
      center: {lat:25.7661932, lng: -80.19618059999999}
    }
    // New Map
    var map = new 
    google.maps.Map(document.getElementById('map'), options);

    //listen for click on map
    google.maps.event.addListener(map, 'click',
    function(event){
      addMarker({coords:event.latLng});
    })

    //var currentUser = JSON.parse('{{{json user}}}');
    let markers = JSON.parse('{{{json hotspots}}}')
    console.log(markers)

    for(var i=0; i<markers.length; i++){
      addMarker(markers[i]);
    }

    //Add Marker function
      function addMarker(props){
        console.log(props)
        var marker = new google.maps.Marker({
        position: {lat:Number(props.lat), lng:Number(props.lon)},//props.coords,
        map:map,
      });
      //check content
      if(props.name){
        var infoWindow = new google.maps.InfoWindow({
      content: props.name
    });
    marker.addListener('click', function(){
      infoWindow.open(map, marker);
    });
      }
    }
  }
</script>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBDHQg3R9w2fSbdKrYv1vrKAE5sdOJ2uLU&callback=initMap">
</script>

<a href="/profile">Back to your Profile</a>